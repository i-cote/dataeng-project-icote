from sqlalchemy import create_engine
def create_star_schema():
    """Create the star schema tables in the PostgreSQL database."""
    engine = create_engine("postgresql://appuser:apppassword@app-db:5432/appdb")
    with engine.connect() as conn:
        conn.execute("""
        CREATE TABLE IF NOT EXISTS arrests (
            arrest_key BIGINT PRIMARY KEY,
            arrest_date DATE,
            pd_cd VARCHAR(10),
            pd_desc VARCHAR(255),
            ky_cd VARCHAR(10),
            ofns_desc VARCHAR(255),
            law_code VARCHAR(20),
            law_cat_cd CHAR(1),
            age_group VARCHAR(20),
            perp_sex CHAR(1),
            perp_race VARCHAR(50),
            arrest_boro CHAR(1),
            arrest_precinct INT,
            jurisdiction_code INT,
            geoid VARCHAR(20) NOT NULL
        );

        CREATE TABLE IF NOT EXISTS geography_of_ethnicity (
            borough VARCHAR(255) NOT NULL,
            geoid VARCHAR(20) NOT NULL,
            ethnicity_total_population INT NOT NULL,
            ethnicity_mexican FLOAT,
            ethnicity_central_american FLOAT,
            ethnicity_costa_rican FLOAT,
            ethnicity_guatemalan FLOAT,
            ethnicity_honduran FLOAT,
            ethnicity_nicaraguan FLOAT,
            ethnicity_panamanian FLOAT,
            ethnicity_salvadoran FLOAT,
            ethnicity_south_american FLOAT,
            ethnicity_argentinean FLOAT,
            ethnicity_bolivian FLOAT,
            ethnicity_chilean FLOAT,
            ethnicity_colombian FLOAT,
            ethnicity_ecuadorian FLOAT,
            ethnicity_paraguayan FLOAT,
            ethnicity_peruvian FLOAT,
            ethnicity_uruguayan FLOAT,
            ethnicity_venezuelan FLOAT,
            ethnicity_caribbean_hispanic FLOAT,
            ethnicity_cuban FLOAT,
            ethnicity_dominican FLOAT,
            ethnicity_puerto_rican FLOAT,
            ethnicity_other_hispanic_latino_or_spanish FLOAT,
            ethnicity_spaniard FLOAT,
            ethnicity_spanish FLOAT,
            ethnicity_spanish_american FLOAT,
            ethnicity_garifuna FLOAT,
            ethnicity_european FLOAT,
            ethnicity_albanian FLOAT,
            ethnicity_armenian FLOAT,
            ethnicity_austrian FLOAT,
            ethnicity_azerbaijani FLOAT,
            ethnicity_belarusian FLOAT,
            ethnicity_belgian FLOAT,
            ethnicity_bosnian_and_herzegovinian FLOAT,
            ethnicity_british FLOAT,
            ethnicity_bulgarian FLOAT,
            ethnicity_croatian FLOAT,
            ethnicity_cypriot FLOAT,
            ethnicity_czech FLOAT,
            ethnicity_danish FLOAT,
            ethnicity_dutch FLOAT,
            ethnicity_english FLOAT,
            ethnicity_estonian FLOAT,
            ethnicity_finnish FLOAT,
            ethnicity_french FLOAT,
            ethnicity_georgian FLOAT,
            ethnicity_german FLOAT,
            ethnicity_greek FLOAT,
            ethnicity_hungarian FLOAT,
            ethnicity_irish FLOAT,
            ethnicity_italian FLOAT,
            ethnicity_kosovan FLOAT,
            ethnicity_latvian FLOAT,
            ethnicity_lithuanian FLOAT,
            ethnicity_macedonian FLOAT,
            ethnicity_maltese FLOAT,
            ethnicity_moldovan FLOAT,
            ethnicity_montenegrin FLOAT,
            ethnicity_norwegian FLOAT,
            ethnicity_polish FLOAT,
            ethnicity_portuguese FLOAT,
            ethnicity_romanian FLOAT,
            ethnicity_russian FLOAT,
            ethnicity_scandinavian FLOAT,
            ethnicity_scots_irish FLOAT,
            ethnicity_scottish FLOAT,
            ethnicity_serbian FLOAT,
            ethnicity_slavic FLOAT,
            ethnicity_slovak FLOAT,
            ethnicity_slovenian FLOAT,
            ethnicity_swedish FLOAT,
            ethnicity_swiss FLOAT,
            ethnicity_turkish FLOAT,
            ethnicity_ukrainian FLOAT,
            ethnicity_welsh FLOAT,
            ethnicity_middle_eastern_or_north_african FLOAT,
            ethnicity_algerian FLOAT,
            ethnicity_arab FLOAT,
            ethnicity_egyptian FLOAT,
            ethnicity_iranian FLOAT,
            ethnicity_iraqi FLOAT,
            ethnicity_israeli FLOAT,
            ethnicity_jordanian FLOAT,
            ethnicity_lebanese FLOAT,
            ethnicity_moroccan FLOAT,
            ethnicity_palestinian FLOAT,
            ethnicity_syrian FLOAT,
            ethnicity_tunisian FLOAT,
            ethnicity_yemeni FLOAT,
            ethnicity_other_white FLOAT,
            ethnicity_australian FLOAT,
            ethnicity_canadian FLOAT,
            ethnicity_french_canadian FLOAT,
            ethnicity_new_zealander FLOAT,
            ethnicity_african_american FLOAT,
            ethnicity_sub_saharan_african FLOAT,
            ethnicity_burkinabe FLOAT,
            ethnicity_cameroonian FLOAT,
            ethnicity_congolese FLOAT,
            ethnicity_ethiopian FLOAT,
            ethnicity_gambian FLOAT,
            ethnicity_ghanaian FLOAT,
            ethnicity_guinean FLOAT,
            ethnicity_ivoirian FLOAT,
            ethnicity_kenyan FLOAT,
            ethnicity_liberian FLOAT,
            ethnicity_malian FLOAT,
            ethnicity_nigerian FLOAT,
            ethnicity_senegalese FLOAT,
            ethnicity_sierra_leonean FLOAT,
            ethnicity_south_african FLOAT,
            ethnicity_sudanese FLOAT,
            ethnicity_togolese FLOAT,
            ethnicity_caribbean FLOAT,
            ethnicity_antiguan_and_barbudan FLOAT,
            ethnicity_bahamian FLOAT,
            ethnicity_barbadian FLOAT,
            ethnicity_dominica_islander FLOAT,
            ethnicity_grenadian FLOAT,
            ethnicity_haitian FLOAT,
            ethnicity_jamaican FLOAT,
            ethnicity_kittian_and_nevisian FLOAT,
            ethnicity_st_lucian FLOAT,
            ethnicity_trinidadian_and_tobagonian FLOAT,
            ethnicity_us_virgin_islander FLOAT,
            ethnicity_vincentian FLOAT,
            ethnicity_west_indian FLOAT,
            ethnicity_other_black_or_african_american FLOAT,
            ethnicity_alaska_native FLOAT,
            ethnicity_american_indian FLOAT,
            ethnicity_blackfeet_tribe_of_the_blackfeet_indian_reservation_of_montana FLOAT,
            ethnicity_cherokee FLOAT,
            ethnicity_central_american_indian_all_tribes FLOAT,
            ethnicity_mexican_indian_all_tribes FLOAT,
            ethnicity_aztec FLOAT,
            ethnicity_south_american_indian_all_tribes FLOAT,
            ethnicity_ecuadorian_indian FLOAT,
            ethnicity_guyanese_south_american_indian FLOAT,
            ethnicity_inca FLOAT,
            ethnicity_caribbean_indian_all_tribes FLOAT,
            ethnicity_taino FLOAT,
            ethnicity_mesoamerican_indian_all_tribes FLOAT,
            ethnicity_maya FLOAT,
            ethnicity_east_asian FLOAT,
            ethnicity_chinese_except_taiwanese FLOAT,
            ethnicity_japanese FLOAT,
            ethnicity_korean FLOAT,
            ethnicity_taiwanese FLOAT,
            ethnicity_central_asian FLOAT,
            ethnicity_afghan FLOAT,
            ethnicity_kazakh FLOAT,
            ethnicity_kyrgyz FLOAT,
            ethnicity_tajik FLOAT,
            ethnicity_uzbek FLOAT,
            ethnicity_south_asian FLOAT,
            ethnicity_asian_indian FLOAT,
            ethnicity_bangladeshi FLOAT,
            ethnicity_nepalese FLOAT,
            ethnicity_pakistani FLOAT,
            ethnicity_sikh FLOAT,
            ethnicity_sri_lankan FLOAT,
            ethnicity_southeast_asian FLOAT,
            ethnicity_burmese FLOAT,
            ethnicity_cambodian FLOAT,
            ethnicity_filipino FLOAT,
            ethnicity_indonesian FLOAT,
            ethnicity_malaysian FLOAT,
            ethnicity_singaporean FLOAT,
            ethnicity_thai FLOAT,
            ethnicity_vietnamese FLOAT,
            ethnicity_other_asian FLOAT,
            ethnicity_polynesian FLOAT,
            ethnicity_native_hawaiian FLOAT,
            ethnicity_samoan FLOAT,
            ethnicity_micronesian FLOAT,
            ethnicity_chamorro FLOAT,
            ethnicity_belizean FLOAT,
            ethnicity_brazilian FLOAT,
            ethnicity_guyanese FLOAT,
            PRIMARY KEY (geoid)
        );
        """)